# Django & next.js 포트폴리오 구축(25.11.19)

## 1. 문제 개요

- Django와 Next.js를 연결해 포트폴리오 API/프로젝트 카드 UI를 구성하던 중,
- Django media 파일이 404로 접근 불가
- BASE_DIR 타입 오류로 settings.py에서 TypeError 발생
- Next.js에서 API 데이터를 받아도 이미지가 렌더링되지 않음
- Next.js 코드 수정 후 화면에 실시간 반영이 안 됨 (HMR 작동 안 함)

등 다양한 문제가 한 번에 터짐...


## 2. 원인분석

### 1) BASE DIR이 string으로 덮어쓰기 됨
setting.py에 BASE_DIR 설정이 두번 존재해 Path객체 -> string으로 변환됨
-> Path 연산 불가(TypeError)

### 2) MEDIA 파일 서빙 설정 누락
urls.py에 static(settings.MEDIA_URL..)설정이 없어서 django가 media폴더를 전혀 서빙하지 못하고 404 발생
-> 사실 media 폴더를 안만들고 컴퓨터 파일어딘가에 있는 사진 아무거나 넣었었던것도 원인이었을수도 .. 

### 3) Next.js 화면이 실시간 반영이 안됨 (HMR 정상작동 불가)
원인은 매우 단순했지만.. 꽤 오랜시간 잡아먹었던 에러..(?)

- 다른 프레임워크엔 기본으로 설정해놨던 자동저장(autosave) 옵션이 집에있는 데스크탑 VSCode 꺼져있었음..(사실 잘 안썼슴..)
-> 파일이 저장되지 않으니 Next.js에서 반영될리가 없음..

- 자동저장 활성화 + 딜레이 500ms설정후 정상 반영됨
(해결과정에서 한번 더 설명할 예정..)

## 3. 해결과정(타임라인)

1) BASE_DIR 중복선언 제거
string 버전 BASE_DIR 삭제 -> PATH 버전만 유지
-> 타입에러 즉시 해결됨


2) MEDIA 설정 재정비
setting.py : (추가)
```
MEDIA_URL = "/media/"
MEDIA_ROOT = BASE_DIR / "media"
```

urls.py : (추가)
```
from django.conf import settings
from django.conf.urls.static import static

if settings.DEBUG:
    urlpatterns += static(settings.MEDIA_URL, document_root=settings.MEDIA_ROOT)
```

=> /media/ ... 경로 접근 성공 !! 

3) Next.js 이미지 URL 절대경로로 수정

```
src={'http://127.0.0.1:8080${project.thumbnail}'}
```
=> 썸네일 정상 렌더링

4) Next.js실시간 반영문제 해결
문제 
- 코드 수정후에도 브라우저에서 아무런 변화 감지를 못함(Next.js 로고 화면만 뜸)
- next dev는 정상 실행중이지만 HMR이 동작하지않음..

원인 : 
-> VSCode 자동저장 OFF
-> 파일이 실제로 디스크에 저장되고있지 도! 않았음


해결 : 
자동저장 : 딜레이 500ms로 설정 
서버 재시작 후 next.js가 즉시 수정사항을 감지 -> 실시간 반영 정상 작동!

## 4. 최종결과 
- django -> Next.js API 연결 안정화
- 미디어 파일 정상 서빙
- 포트폴리오 카드/모달 UI완성
- Next.js HMR 정상작동 재개 
- 실시간으로 반영되는 UI로 개발 속도도 좋아짐 (자동저장은 꼭 프레임워크가 바뀌면 체크하자 !)

## 5. 이번 이슈로 배운점
- BASE_DIR, media, static, CORS등 기초 설정 하나하나가 모든 구조에 영향.. (구조 분석을 조금더 꼼꼼히 공부해야겠다)
- 개발은 !!저장!! 이 반영의 핵심(저장을 안하면 반응해주지 않더라 .. )
- MEDIA는 django에서 반드시 직접 serve 해줘야 한다! (..자동이 아니더라 ..)
- 백엔드 - 프론트 연결은 "절대/상대경로"를 명확히 이해해야한다 ..! (미디어/파일/ 링크는 ... 주의하자 ..)
- 작은 설정하나가 개발 시간을 결정한다 ... (에러가 엄청터져서 당황스러웠ㄷ..)

## 6. 다음에 해야할것!
- 프로젝트 이미지 여러장 업로드할수있게 하기 ..! (슬라이더나 .. 뭐 .. 아무튼 여러개 보이게끔) 제작
- 프로젝트 카드 hover 애니메이션
- 프로젝트 상세 페이지(가능하다면..?)
- 포트폴리오 UI 전체적인 색감 조정

